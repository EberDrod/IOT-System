'use strict ';function cov_1qn58rx6lb(){var path="/Users/eberpena/Desktop/iot/iot-db/lib/agent.js";var hash="ed501eeb05cbbcdb3115d2f1e814e28085ef99f6";var global=new Function("return this")();var gcv="__coverage__";var coverageData={path:"/Users/eberpena/Desktop/iot/iot-db/lib/agent.js",statementMap:{"0":{start:{line:3,column:0},end:{line:60,column:1}},"1":{start:{line:5,column:21},end:{line:9,column:9}},"2":{start:{line:11,column:30},end:{line:11,column:60}},"3":{start:{line:12,column:8},end:{line:15,column:9}},"4":{start:{line:13,column:28},end:{line:13,column:63}},"5":{start:{line:14,column:12},end:{line:14,column:69}},"6":{start:{line:17,column:23},end:{line:17,column:53}},"7":{start:{line:18,column:8},end:{line:18,column:30}},"8":{start:{line:24,column:8},end:{line:24,column:38}},"9":{start:{line:28,column:9},end:{line:32,column:11}},"10":{start:{line:36,column:9},end:{line:36,column:36}},"11":{start:{line:40,column:9},end:{line:44,column:11}},"12":{start:{line:48,column:8},end:{line:53,column:10}},"13":{start:{line:56,column:4},end:{line:59,column:5}}},fnMap:{"0":{name:"setupAgent",decl:{start:{line:3,column:26},end:{line:3,column:36}},loc:{start:{line:3,column:50},end:{line:60,column:1}},line:3},"1":{name:"createOrUpdate",decl:{start:{line:4,column:19},end:{line:4,column:33}},loc:{start:{line:4,column:41},end:{line:21,column:5}},line:4},"2":{name:"findById",decl:{start:{line:23,column:13},end:{line:23,column:21}},loc:{start:{line:23,column:26},end:{line:25,column:5}},line:23},"3":{name:"findByUuid",decl:{start:{line:27,column:14},end:{line:27,column:24}},loc:{start:{line:27,column:31},end:{line:33,column:6}},line:27},"4":{name:"findAll",decl:{start:{line:35,column:14},end:{line:35,column:21}},loc:{start:{line:35,column:24},end:{line:37,column:6}},line:35},"5":{name:"findConnected",decl:{start:{line:39,column:14},end:{line:39,column:27}},loc:{start:{line:39,column:31},end:{line:45,column:6}},line:39},"6":{name:"findByUsername",decl:{start:{line:47,column:13},end:{line:47,column:27}},loc:{start:{line:47,column:38},end:{line:54,column:5}},line:47}},branchMap:{"0":{loc:{start:{line:12,column:8},end:{line:15,column:9}},type:"if",locations:[{start:{line:12,column:8},end:{line:15,column:9}},{start:{line:12,column:8},end:{line:15,column:9}}],line:12},"1":{loc:{start:{line:14,column:19},end:{line:14,column:69}},type:"cond-expr",locations:[{start:{line:14,column:29},end:{line:14,column:53}},{start:{line:14,column:56},end:{line:14,column:69}}],line:14}},s:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0,"7":0,"8":0,"9":0,"10":0,"11":0,"12":0,"13":0},f:{"0":0,"1":0,"2":0,"3":0,"4":0,"5":0,"6":0},b:{"0":[0,0],"1":[0,0]},_coverageSchema:"1a1c01bbd47fc00a2c39e90264f33305004495a9",hash:"ed501eeb05cbbcdb3115d2f1e814e28085ef99f6"};var coverage=global[gcv]||(global[gcv]={});if(!coverage[path]||coverage[path].hash!==hash){coverage[path]=coverageData;}var actualCoverage=coverage[path];{// @ts-ignore
cov_1qn58rx6lb=function(){return actualCoverage;};}return actualCoverage;}cov_1qn58rx6lb();cov_1qn58rx6lb().s[0]++;module.exports=function setupAgent(AgentModel){cov_1qn58rx6lb().f[0]++;async function createOrUpdate(agent){cov_1qn58rx6lb().f[1]++;const cond=(cov_1qn58rx6lb().s[1]++,{where:{uuid:agent.uuid}});const existingAgent=(cov_1qn58rx6lb().s[2]++,await AgentModel.findOne(cond));cov_1qn58rx6lb().s[3]++;if(existingAgent){cov_1qn58rx6lb().b[0][0]++;const updated=(cov_1qn58rx6lb().s[4]++,await AgentModel.update(agent,cond));cov_1qn58rx6lb().s[5]++;return updated?(cov_1qn58rx6lb().b[1][0]++,AgentModel.findOne(cond)):(cov_1qn58rx6lb().b[1][1]++,existingAgent);}else{cov_1qn58rx6lb().b[0][1]++;}const result=(cov_1qn58rx6lb().s[6]++,await AgentModel.create(agent));cov_1qn58rx6lb().s[7]++;return result.toJSON();}function findById(id){cov_1qn58rx6lb().f[2]++;cov_1qn58rx6lb().s[8]++;return AgentModel.findById(id);}function findByUuid(uuid){cov_1qn58rx6lb().f[3]++;cov_1qn58rx6lb().s[9]++;return AgentModel.findOne({where:{uuid}});}function findAll(){cov_1qn58rx6lb().f[4]++;cov_1qn58rx6lb().s[10]++;return AgentModel.findAll();}function findConnected(){cov_1qn58rx6lb().f[5]++;cov_1qn58rx6lb().s[11]++;return AgentModel.findAll({where:{connected:true}});}function findByUsername(username){cov_1qn58rx6lb().f[6]++;cov_1qn58rx6lb().s[12]++;return AgentModel.findAll({where:{username,connected:true}});}cov_1qn58rx6lb().s[13]++;return{createOrUpdate,findById};};
//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJzb3VyY2VzIjpbImFnZW50LmpzIl0sIm5hbWVzIjpbIm1vZHVsZSIsImV4cG9ydHMiLCJzZXR1cEFnZW50IiwiQWdlbnRNb2RlbCIsImNyZWF0ZU9yVXBkYXRlIiwiYWdlbnQiLCJjb25kIiwid2hlcmUiLCJ1dWlkIiwiZXhpc3RpbmdBZ2VudCIsImZpbmRPbmUiLCJ1cGRhdGVkIiwidXBkYXRlIiwicmVzdWx0IiwiY3JlYXRlIiwidG9KU09OIiwiZmluZEJ5SWQiLCJpZCIsImZpbmRCeVV1aWQiLCJmaW5kQWxsIiwiZmluZENvbm5lY3RlZCIsImNvbm5lY3RlZCIsImZpbmRCeVVzZXJuYW1lIiwidXNlcm5hbWUiXSwibWFwcGluZ3MiOiJBQUFBLGMseTFGQWVZO21IQWJaQSxNQUFNLENBQUNDLE9BQVAsQ0FBaUIsUUFBU0MsQ0FBQUEsVUFBVCxDQUFxQkMsVUFBckIsQ0FBaUMseUJBQzlDLGNBQWVDLENBQUFBLGNBQWYsQ0FBK0JDLEtBQS9CLENBQXFDLHlCQUNqQyxLQUFNQyxDQUFBQSxJQUFJLDBCQUFHLENBQ1RDLEtBQUssQ0FBRSxDQUNIQyxJQUFJLENBQUVILEtBQUssQ0FBQ0csSUFEVCxDQURFLENBQUgsQ0FBVixDQU1BLEtBQU1DLENBQUFBLGFBQWEsMEJBQUcsS0FBTU4sQ0FBQUEsVUFBVSxDQUFDTyxPQUFYLENBQW1CSixJQUFuQixDQUFULENBQW5CLENBUGlDLHdCQVFqQyxHQUFJRyxhQUFKLENBQW1CLDRCQUNmLEtBQU1FLENBQUFBLE9BQU8sMEJBQUcsS0FBTVIsQ0FBQUEsVUFBVSxDQUFDUyxNQUFYLENBQWtCUCxLQUFsQixDQUF3QkMsSUFBeEIsQ0FBVCxDQUFiLENBRGUsd0JBRWYsTUFBT0ssQ0FBQUEsT0FBTyw2QkFBR1IsVUFBVSxDQUFDTyxPQUFYLENBQW1CSixJQUFuQixDQUFILDhCQUE4QkcsYUFBOUIsQ0FBZCxDQUNILENBSEQsaUNBS0EsS0FBTUksQ0FBQUEsTUFBTSwwQkFBRyxLQUFNVixDQUFBQSxVQUFVLENBQUNXLE1BQVgsQ0FBa0JULEtBQWxCLENBQVQsQ0FBWixDQWJpQyx3QkFjakMsTUFBT1EsQ0FBQUEsTUFBTSxDQUFDRSxNQUFQLEVBQVAsQ0FHSCxDQUVELFFBQVNDLENBQUFBLFFBQVQsQ0FBa0JDLEVBQWxCLENBQXNCLGlEQUNsQixNQUFPZCxDQUFBQSxVQUFVLENBQUNhLFFBQVgsQ0FBb0JDLEVBQXBCLENBQVAsQ0FDSCxDQUVBLFFBQVNDLENBQUFBLFVBQVQsQ0FBcUJWLElBQXJCLENBQTBCLGlEQUN0QixNQUFPTCxDQUFBQSxVQUFVLENBQUNPLE9BQVgsQ0FBbUIsQ0FDdEJILEtBQUssQ0FBQyxDQUNGQyxJQURFLENBRGdCLENBQW5CLENBQVAsQ0FLSCxDQUVELFFBQVNXLENBQUFBLE9BQVQsRUFBbUIsa0RBQ2YsTUFBT2hCLENBQUFBLFVBQVUsQ0FBQ2dCLE9BQVgsRUFBUCxDQUNILENBRUQsUUFBU0MsQ0FBQUEsYUFBVCxFQUEwQixrREFDdEIsTUFBT2pCLENBQUFBLFVBQVUsQ0FBQ2dCLE9BQVgsQ0FBbUIsQ0FDdEJaLEtBQUssQ0FBRSxDQUNIYyxTQUFTLENBQUUsSUFEUixDQURlLENBQW5CLENBQVAsQ0FLSCxDQUVGLFFBQVNDLENBQUFBLGNBQVQsQ0FBeUJDLFFBQXpCLENBQWtDLGtEQUM5QixNQUFPcEIsQ0FBQUEsVUFBVSxDQUFDZ0IsT0FBWCxDQUFtQixDQUN0QlosS0FBSyxDQUFFLENBQ0hnQixRQURHLENBRUhGLFNBQVMsQ0FBRSxJQUZSLENBRGUsQ0FBbkIsQ0FBUCxDQU1ILENBbkQ2Qyx5QkFxRDlDLE1BQU8sQ0FDSGpCLGNBREcsQ0FFSFksUUFGRyxDQUFQLENBSUgsQ0F6REQiLCJzb3VyY2VzQ29udGVudCI6WyIndXNlIHN0cmljdCAnXG5cbm1vZHVsZS5leHBvcnRzID0gZnVuY3Rpb24gc2V0dXBBZ2VudCAoQWdlbnRNb2RlbCkge1xuICAgIGFzeW5jIGZ1bmN0aW9uIGNyZWF0ZU9yVXBkYXRlIChhZ2VudCl7XG4gICAgICAgIGNvbnN0IGNvbmQgPSB7XG4gICAgICAgICAgICB3aGVyZToge1xuICAgICAgICAgICAgICAgIHV1aWQ6IGFnZW50LnV1aWRcbiAgICAgICAgICAgIH1cbiAgICAgICAgfVxuXG4gICAgICAgIGNvbnN0IGV4aXN0aW5nQWdlbnQgPSBhd2FpdCBBZ2VudE1vZGVsLmZpbmRPbmUoY29uZClcbiAgICAgICAgaWYoIGV4aXN0aW5nQWdlbnQpIHtcbiAgICAgICAgICAgIGNvbnN0IHVwZGF0ZWQgPSBhd2FpdCBBZ2VudE1vZGVsLnVwZGF0ZShhZ2VudCxjb25kKVxuICAgICAgICAgICAgcmV0dXJuIHVwZGF0ZWQgPyBBZ2VudE1vZGVsLmZpbmRPbmUoY29uZCkgOiBleGlzdGluZ0FnZW50XG4gICAgICAgIH1cblxuICAgICAgICBjb25zdCByZXN1bHQgPSBhd2FpdCBBZ2VudE1vZGVsLmNyZWF0ZShhZ2VudClcbiAgICAgICAgcmV0dXJuIHJlc3VsdC50b0pTT04oKVxuXG5cbiAgICB9XG5cbiAgICBmdW5jdGlvbiBmaW5kQnlJZChpZCkge1xuICAgICAgICByZXR1cm4gQWdlbnRNb2RlbC5maW5kQnlJZChpZClcbiAgICB9XG5cbiAgICAgZnVuY3Rpb24gZmluZEJ5VXVpZCAodXVpZCl7XG4gICAgICAgICByZXR1cm4gQWdlbnRNb2RlbC5maW5kT25lKHtcbiAgICAgICAgICAgICB3aGVyZTp7XG4gICAgICAgICAgICAgICAgIHV1aWRcbiAgICAgICAgICAgICB9XG4gICAgICAgICB9KVxuICAgICB9XG5cbiAgICAgZnVuY3Rpb24gZmluZEFsbCgpIHtcbiAgICAgICAgIHJldHVybiBBZ2VudE1vZGVsLmZpbmRBbGwoKVxuICAgICB9XG5cbiAgICAgZnVuY3Rpb24gZmluZENvbm5lY3RlZCAoKSB7XG4gICAgICAgICByZXR1cm4gQWdlbnRNb2RlbC5maW5kQWxsKHtcbiAgICAgICAgICAgICB3aGVyZToge1xuICAgICAgICAgICAgICAgICBjb25uZWN0ZWQ6IHRydWVcbiAgICAgICAgICAgICB9XG4gICAgICAgICB9KVxuICAgICB9XG5cbiAgICBmdW5jdGlvbiBmaW5kQnlVc2VybmFtZSAodXNlcm5hbWUpe1xuICAgICAgICByZXR1cm4gQWdlbnRNb2RlbC5maW5kQWxsKHtcbiAgICAgICAgICAgIHdoZXJlOiB7XG4gICAgICAgICAgICAgICAgdXNlcm5hbWUsIFxuICAgICAgICAgICAgICAgIGNvbm5lY3RlZDogdHJ1ZVxuICAgICAgICAgICAgfVxuICAgICAgICB9KVxuICAgIH1cblxuICAgIHJldHVybiB7XG4gICAgICAgIGNyZWF0ZU9yVXBkYXRlLFxuICAgICAgICBmaW5kQnlJZFxuICAgIH1cbn0iXX0=